[project]
name = "pdag"
version = "0.0.1"
description = "Parameterized Directed Acyclic Graph"
readme = "README.md"
authors = [
    { name = "Shunichiro Nomura", email = "nomura@space.t.u-tokyo.ac.jp" },
]
requires-python = ">=3.12"
dependencies = ["asttokens>=3.0.0", "rich>=13.9.4", "typing-extensions>=4.12.2"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[dependency-groups]
dev = [
    "pre-commit==4.1.0",
    { include-group = "ruff" },
    { include-group = "typing" },
    { include-group = "testing" },
    { include-group = "examples" },
]
ruff = ["ruff==0.9.9"]
typing = [
    "mypy==1.15.0",
    { include-group = "testing" },
    { include-group = "examples" },
    "pandas-stubs==2.2.3.241126",
    "types-tqdm==4.67.0.20250301",
]
testing = ["coverage==7.6.12", "pytest==8.3.5"]
examples = [
    "altair==5.5.0",
    "marimo==0.11.13",
    "pandas==2.2.3",
    "rich==13.9.4",
    "tqdm==4.67.1",
]
lint = ["deptry>=0.23.0", "import-linter>=2.2"]

[tool.mypy]
strict = true

[[tool.mypy.overrides]]
module = ["networkx.*", "pydot.*"]
ignore_missing_imports = true

[tool.deptry.per_rule_ignores]
"DEP003" = ["pdag"] # Allow absolute imports in pdag package

[tool.importlinter]
root_package = "pdag"

[[tool.importlinter.contracts]]
name = "layered models"
type = "layers"
layers = [
    "pdag.examples",
    "pdag._exec | pdag._notation",
    "pdag._core",
    "pdag.utils",
]
